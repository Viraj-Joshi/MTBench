#!/bin/bash

for e in 8192
do
	if [ $e -eq 500 ]; then
		task_counts=[10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10]
		minibatch_size=8000
	elif [ $e -eq 2048 ]; then
		task_counts=[41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,40,40]
		minibatch_size=32768
	elif [ $e -eq 4096 ]; then
		task_counts=[82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,81,81,81,81]
		minibatch_size=32768
	elif [ $e -eq 8192 ]; then
		task_counts=[164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,163,163,163,163,163,163,163,163]
		minibatch_size=65536
	elif [ $e -eq 16384 ]; then
		task_counts=[328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,327,327,327,327,327,327,327,327,327,327,327,327,327,327,327,327]
		minibatch_size=65536
	else
		task_counts=[492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,491,491,491,491,491,491,491,491,491,491,491,491,491,491,491,491,491,491,491,491,491,491,491,491]
		minibatch_size=65536
	fi

	t=$((1000000000 / (e * 32)))
	for i in 42 43 44
	do
		cmd="python isaacgymenvs/train.py \
			task_id=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49] \
			task_counts=$task_counts \
			num_envs=$e \
			task=meta-world-v2 \
			fixed=False \
			reward_scale=100 \
			termination_on_success=False \
			experiment=ppo_pcgrad_mt50_rand_envs_${e}_mb_${minibatch_size}_seed_$i \
			train=meta-world-mt50-pcgrad-PPO \
			seed=$i \
			wandb_activate=True \
			wandb_project=IsaacGym \
			sim_device=cuda:0 \
			rl_device=cuda:0 \
			headless=True \
			record_videos=False \
			max_iterations=$t \
			minibatch_size=$minibatch_size"
		echo $cmd
		$cmd
	done
done