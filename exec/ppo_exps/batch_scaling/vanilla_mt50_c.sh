#!/bin/bash

for e in 4096
do
	for n in 32 64
	do
		g_steps=$((((e * n) / 32768)*5))
		t=$((60000 / g_steps))
		if [ $e -eq 128 ]; then
			task_counts=[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2]
		elif [ $e -eq 256 ]; then
			task_counts=[5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6]
		elif [ $e -eq 512 ]; then
			task_counts=[11,11,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10]
		elif [ $e -eq 1024 ]; then
			task_counts=[21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20]
		elif [ $e -eq 2048 ]; then
			task_counts=[41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,40,40]
		elif [ $e -eq 4096 ]; then
			task_counts=[82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,81,81,81,81]
		elif [ $e -eq 8192 ]; then
			task_counts=[164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,164,163,163,163,163,163,163,163,163]
		elif [ $e -eq 16384 ]; then
			task_counts=[328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,328,327,327,327,327,327,327,327,327,327,327,327,327,327,327,327,327]
		elif [ $e -eq 32768 ]; then
			task_counts=[656,656,656,656,656,656,656,656,656,656,656,656,656,656,656,656,656,656,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655,655]
		fi
		for i in 42 43 44 45 46
		do
			cmd="python isaacgymenvs/train.py \
				task_id=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49] \
				task_counts=$task_counts \
				num_envs=$e \
				task=meta-world-v2 \
				fixed=False \
				reward_scale=100 \
				termination_on_success=False \
				experiment=08_10_ppo_vanilla_TE_mt50_rand_batch_scaling_e_${e}_n_${n}_seed_${i} \
				train=meta-world-mt50-vanilla-asymmetric2-PPO \
				seed=$i \
				wandb_activate=True \
				wandb_project=IsaacGym \
				sim_device=cuda:0 \
				rl_device=cuda:0 \
				headless=True \
				record_videos=False \
				reward_scale=100 \
				termination_on_success=False \
				max_iterations=$t \
				units=[1500,1500,1500] \
				learn_task_embedding=True \
				horizon=$n \
				minibatch_size=32768"
			echo $cmd
			$cmd
		done
	done
done